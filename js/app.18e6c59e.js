(function(){"use strict";var e={974:function(e,t,a){var n=a(5130),o=a(6768),l=a(782),i=(0,o.pM)({__name:"LoadSpinner",setup(e){const t=(0,l.Pj)(),a=(0,o.EW)((()=>t.getters.isLoading));return(e,t)=>{const n=(0,o.g2)("v-progress-circular"),l=(0,o.g2)("v-card-text"),i=(0,o.g2)("v-card-title"),r=(0,o.g2)("v-card"),s=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.Wv)(s,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),persistent:"",width:"auto"},{default:(0,o.k6)((()=>[(0,o.bF)(r,{color:"white"},{default:(0,o.k6)((()=>[(0,o.bF)(l,null,{default:(0,o.k6)((()=>[(0,o.bF)(n,{indeterminate:"",color:"primary",size:128,width:16})])),_:1}),(0,o.bF)(i,{style:{"text-align":"center"}},{default:(0,o.k6)((()=>[(0,o.eW)("Loading...")])),_:1})])),_:1})])),_:1},8,["modelValue"])}}});const r=i;var s=r,c=a(4232),u=a(144);const d={class:"container"},p={class:"container"};var m=(0,o.pM)({__name:"DatePicker",props:{modelValue:{},label:{default:"Select Date"},disableAfter:{},disableBefore:{}},emits:["date-changed"],setup(e,{emit:t}){const a=e,n=t,l=(0,u.KR)(!1),i=(0,u.KR)(a.modelValue?new Date(a.modelValue).toISOString():(new Date).toISOString()),r=(0,o.EW)({get:()=>new Date(i.value),set:e=>{i.value=e.toISOString()}}),s=(0,o.EW)((()=>new Date(i.value).toLocaleDateString()));function m(){i.value=new Date(r.value).toISOString(),n("date-changed",i.value)}const v=e=>{const t=!a.disableBefore||new Date(e)>=new Date(a.disableBefore),n=!a.disableAfter||new Date(e)<=new Date(a.disableAfter);return t&&n};return(0,o.wB)((()=>a.modelValue),(e=>{i.value=e||(new Date).toISOString()}),{immediate:!0,deep:!0}),(e,t)=>{const n=(0,o.g2)("v-text-field"),i=(0,o.g2)("v-date-picker"),u=(0,o.g2)("v-menu");return(0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("div",p,[(0,o.bF)(u,{modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=e=>l.value=e),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"290px"},{activator:(0,o.k6)((({props:e})=>[(0,o.Lk)("div",(0,c._B)((0,o.Ng)(e)),[(0,o.bF)(n,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value=e),label:a.label,"prepend-inner-icon":"mdi-calendar",readonly:"","hide-details":"","bg-color":"white"},null,8,["modelValue","label"])],16)])),default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:r.value,"onUpdate:modelValue":[t[1]||(t[1]=e=>r.value=e),m],"allowed-dates":v},null,8,["modelValue"])])),_:1},8,["modelValue"])])])}}}),v=a(1241);const g=(0,v.A)(m,[["__scopeId","data-v-67493190"]]);var f=g,b=(a(4114),a(8353));const _={class:"pagination"};var h=(0,o.pM)({__name:"BottomPagination",props:{totalLength:{},pageSize:{default:10},isLast:{type:Boolean}},emits:["paginate"],setup(e,{emit:t}){const{smAndDown:a}=(0,b._F)(),n=e,l=t,i=(0,u.KR)({current:1,pageSize:10});async function r(e){i.value.current=e,l("paginate",{offset:n.pageSize*(i.value.current-1)})}const s=(0,o.EW)((()=>Math.ceil(n.totalLength/n.pageSize))),d=(0,o.EW)((()=>{const e=[];let t=Math.max(1,i.value.current-2),a=Math.min(t+4,s.value);a-t<4&&(t=Math.max(1,a-4));for(let n=t;n<=a;n++)e.push(n);return e})),p=(0,o.EW)((()=>a?"small":"default"));return(e,t)=>{const a=(0,o.g2)("v-icon"),n=(0,o.g2)("v-btn");return(0,o.uX)(),(0,o.CE)("div",_,[(0,o.bF)(n,{disabled:1==i.value.current,onClick:t[0]||(t[0]=e=>r(i.value.current-1)),size:p.value},{default:(0,o.k6)((()=>[(0,o.bF)(a,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-chevron-left")])),_:1})])),_:1},8,["disabled","size"]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(d.value,(e=>((0,o.uX)(),(0,o.Wv)(n,{key:`pag_${e}`,small:"",disabled:e==i.value.current,onClick:t=>r(e),size:p.value},{default:(0,o.k6)((()=>[(0,o.eW)((0,c.v_)(e),1)])),_:2},1032,["disabled","onClick","size"])))),128)),(0,o.bF)(n,{disabled:e.isLast,onClick:t[1]||(t[1]=e=>r(i.value.current+1)),size:p.value},{default:(0,o.k6)((()=>[(0,o.bF)(a,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-chevron-right")])),_:1})])),_:1},8,["disabled","size"])])}}});const k=(0,v.A)(h,[["__scopeId","data-v-6a90452c"]]);var S=k;const w={class:"avatarList"};var y=(0,o.pM)({__name:"AgentAvatarList",props:{agents:{},l2r:{type:Boolean,default:!0},limit:{}},setup(e){const t=e,a=(0,o.EW)((()=>{if(!t.agents)return[];let e=t.agents.map((e=>({text:`${e.name[0]}${e.surname[0]}`,color:e.color,tooltip:`${e.name} ${e.surname}`})));const a=t.agents.length-t.limit;return a>0&&(e=e.slice(0,t.limit),e.push({text:`+${a}`,color:"rgb(168, 168, 168)",tooltip:t.agents.slice(t.limit).map((e=>`${e.name} ${e.surname}`)).join(", ")})),e}));return(e,t)=>{const n=(0,o.g2)("v-avatar"),l=(0,o.g2)("v-tooltip");return(0,o.uX)(),(0,o.CE)("div",w,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.value,((t,a)=>((0,o.uX)(),(0,o.Wv)(l,{key:`agent_${a}`,location:"top"},{activator:(0,o.k6)((({props:l})=>[(0,o.bF)(n,(0,o.v6)({ref_for:!0},l,{color:t.color,style:{"z-index":e.l2r?100-a:100+a,"margin-right":"-5px"}}),{default:(0,o.k6)((()=>[(0,o.eW)((0,c.v_)(t.text),1)])),_:2},1040,["color","style"])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",null,(0,c.v_)(t.tooltip),1)])),_:2},1024)))),128))])}}});const L=(0,v.A)(y,[["__scopeId","data-v-1b70cc6b"]]);var A=L,C=(0,o.pM)({__name:"SelectAgents",props:{agents:{},modelValue:{}},emits:["update:model-value"],setup(e,{emit:t}){const a=e,n=t,l=(0,u.KR)([]);return(0,o.wB)((()=>a.modelValue),(e=>{e&&(l.value=e)}),{immediate:!0,deep:!0}),(0,o.wB)(l,(e=>{n("update:model-value",e)}),{deep:!0}),(e,t)=>{const a=(0,o.g2)("AgentAvatarList"),n=(0,o.g2)("v-checkbox"),i=(0,o.g2)("v-list-item"),r=(0,o.g2)("v-list"),s=(0,o.g2)("v-card"),c=(0,o.g2)("v-menu");return(0,o.uX)(),(0,o.Wv)(c,{location:"bottom","close-on-content-click":!1},{activator:(0,o.k6)((({props:t})=>[(0,o.bF)(a,(0,o.v6)(t,{agents:e.agents,l2r:!1,limit:5,style:{cursor:"pointer"}}),null,16,["agents"])])),default:(0,o.k6)((()=>[(0,o.bF)(s,null,{default:(0,o.k6)((()=>[(0,o.bF)(r,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.agents,((e,a)=>((0,o.uX)(),(0,o.Wv)(i,{key:`select_option_${a}`,class:"listItem"},{default:(0,o.k6)((()=>[(0,o.bF)(n,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),value:e.record_id,label:`${e.name} ${e.surname}`,density:"compact","hide-details":""},null,8,["modelValue","value","label"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})}}});const D=(0,v.A)(C,[["__scopeId","data-v-a7284a44"]]);var F,I,V,E,T=D;(function(e){function t(e){return JSON.parse(JSON.stringify(e))}let a;e.deepCopy=t,function(e){function t(e){const t=new Date(e);return t.toISOString()}function a(e,t){const a=Math.abs(e-t),n=864e5,o=Math.floor(a/n);return o}function n(e,t){const a=36e5;switch(t){case"hour":return a*e;case"day":return 24*a*e;case"week":return 24*a*7*e;case"month":return 24*a*30*e;case"year":return 24*a*365*e}}function o(e){const t=new Date(e);return t.getTime()}function l(e){const t=new Date(e),a=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear(),l=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");return`${a}/${n}/${o} ${l}:${i}`}function i(e){return new Date(e).toLocaleDateString()}e.getISOStringFromTimestamp=t,e.getDaysBetweenTimestamps=a,e.getMS=n,e.dateStringToTS=o,e.formatDateTime=l,e.isoDateToLocal=i}(a=e.Dates||(e.Dates={}))})(F||(F={})),function(e){function t(e){const t=new Date(e),a={day:"2-digit",month:"2-digit",year:"numeric"},n={hour:"2-digit",minute:"2-digit",hour12:!1},o=new Intl.DateTimeFormat("en-GB",a).format(t),l=new Intl.DateTimeFormat("en-GB",n).format(t),i=`${o} ${l}`;return i}function a(e,t,a=!0){return e.length<=t?e:e.substring(0,t)+(a?"...":"")}e.formatDate=t,e.truncateString=a}(I||(I={})),function(e){function t(e){if(e.isCancelled)return{kind:"Cancelled",color:"red"};const t=Date.now(),a=F.Dates.dateStringToTS(e.date),n=t>a?"Completed":"Upcoming";return"Completed"==n?{kind:n,color:"green"}:{kind:n,color:"orange",remainingDays:F.Dates.getDaysBetweenTimestamps(t,a)}}function a(e){const t=e.fields,a={record_id:e.id,id:t.appointment_id,address:t.appointment_address||"",date:t.appointment_date,isCancelled:t.is_cancelled,contact:t.contact_id||[],agent:t.agent_id||[]};return a}e.getStatus=t,e.recordsToModel=a}(V||(V={})),function(e){const t=function(e){return void 0!==e&&null!==e&&""!==e};function a(e){return t(e)||"Required field"}e.required=a}(E||(E={}));var W=a(6508),O=a.n(W);const X="patroCq2VPzyRT5gN.c3f82fef7ba3b266c5ff3a5183168778e315b41d948e10083c02892257b6b725",$="appkTtnhXACqj0kag",x=new(O())({apiKey:X}).base($);var M,K,z;(function(e){const t="tbl9reEf5STrkSA85";e.fetchAll=async()=>{try{const e=await x(t).select().all();console.log("Appointment records fethced:",e.length);const a=e.map((e=>V.recordsToModel(e)));return a.sort(((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()))}catch(e){throw console.error("Error fetching records from Airtable:",e),e}},e.create=async e=>{try{const a=[{fields:{appointment_date:e.date,appointment_address:e.address,contact_id:e.contact,agent_id:e.agent}}],n=await x(t).create(a);return n.map((e=>V.recordsToModel(e)))}catch(a){throw console.error("Error creating record in Airtable:",a),a}},e.update=async(e,a)=>{try{const n=[{id:e,fields:{appointment_date:a.date,appointment_address:a.address,contact_id:a.contact,agent_id:a.agent}}],o=await x(t).update(n);return o.map((e=>V.recordsToModel(e)))}catch(n){throw console.error("Error updating record in Airtable:",n),n}}})(M||(M={})),function(e){const t="tblejF2oJbI8ze105";e.fetchAll=async()=>{try{const e=await x(t).select().all();console.log("Agent records fethced:",e.length);const a=e.map((e=>{const t=e.fields;return{record_id:e.id,number:t.number,name:t.agent_name,surname:t.agent_surname,appointments:t.appointments,color:t.color}}));return a}catch(e){throw console.error("Error fetching records from Airtable:",e),e}}}(K||(K={})),function(e){const t="tbl0TuknKqXHysejd";e.fetchAll=async()=>{try{const e=await x(t).select().all();console.log("Contact records fethced:",e.length);const a=e.map((e=>{const t=e.fields;return{record_id:e.id,id:t.contact_id,name:t.contact_name,surname:t.contact_surname,email:t.contact_email,phone:t.contact_phone,appointments:t.appointments}}));return a}catch(e){throw console.error("Error fetching records from Airtable:",e),e}}}(z||(z={}));const R={Appointment:M,Agent:K,Contact:z},U={class:"main"},B={class:"filters"},P={class:"statusFilter"},N={class:"dateFilter"},j={class:"searchFilter"},G={class:"listHeader"},q={style:{"font-weight":"600"}},Q={class:"list"};var H=(0,o.pM)({__name:"AppointmentList",setup(e){const t=(0,l.Pj)(),a=(0,u.KR)([]),n=(0,u.KR)([]),i=(0,u.KR)([]),r=(0,u.KR)({status:"",searchText:"",from:F.Dates.getISOStringFromTimestamp(Date.now()-F.Dates.getMS(1,"year")),to:F.Dates.getISOStringFromTimestamp(Date.now()+F.Dates.getMS(1,"year")),agents:[]}),s=[{title:"All Statuses",value:""},{title:"Completed",value:"completed"},{title:"Upcoming",value:"upcoming"},{title:"Cancelled",value:"cancelled"}],d=(0,u.KR)({pageSize:10,offset:0}),p=(0,u.KR)({open:!1,model:void 0});function m(e){d.value.offset=e}function v(e,t){console.log("dateChanged"),r.value[e]=t}function g(e){e&&(p.value.model=e),p.value.open=!0}function f(){p.value={open:!1,model:void 0}}async function b(e){try{if(console.log("saveAppointment model",e),!p.value.open)return;t.dispatch("SET_LOADING",!0),p.value.model?await R.Appointment.update(p.value.model.record_id,e):(console.log("creating appt"),await R.Appointment.create(e)),await _(),f()}catch(a){console.error(a)}finally{t.dispatch("SET_LOADING",!1)}}async function _(){const e=await R.Appointment.fetchAll();i.value=e}async function h(){const e=await R.Agent.fetchAll();a.value=e}async function k(){const e=await R.Contact.fetchAll();n.value=e}async function S(){try{t.dispatch("SET_LOADING",!0),await Promise.all([_(),h(),k()])}catch(e){console.error("init err",e)}finally{t.dispatch("SET_LOADING",!1)}}const w=(0,o.EW)((()=>{const e=[...i.value].map((e=>({appointment:e,agents:a.value.filter((t=>e.agent?.includes(String(t.record_id)))),contacts:n.value.filter((t=>e.contact?.includes(String(t.record_id))))}))),t=e.filter((e=>{const t=Date.now(),a=new Date(e.appointment.date).getTime(),n=[a>new Date(r.value.from).getTime(),a<new Date(r.value.to).getTime()];switch(r.value.status){case"completed":n.push(a<t&&!e.appointment.isCancelled);break;case"upcoming":n.push(a>t&&!e.appointment.isCancelled);break;case"cancelled":n.push(e.appointment.isCancelled);break;default:break}if(r.value.agents.length>0&&("object"!==typeof e.appointment.agent&&console.log("agent",e.appointment.agent),n.push(!!e.appointment.agent&&r.value.agents.every((t=>e.appointment.agent.includes(t))))),r.value.searchText){const t=e.contacts.map((e=>e.name+e.surname+e.email+String(e.phone))).join(" "),a=(e.appointment.address+t).toLowerCase();n.push(a.includes(r.value.searchText.toLowerCase()))}return n.every((e=>e))}));return t})),y=(0,o.EW)((()=>w.value.slice(d.value.offset,d.value.offset+d.value.pageSize)));return(0,o.sV)((()=>{S()})),(e,t)=>{const l=(0,o.g2)("SelectAgents"),u=(0,o.g2)("v-select"),_=(0,o.g2)("DatePicker"),h=(0,o.g2)("v-text-field"),k=(0,o.g2)("v-btn"),S=(0,o.g2)("AppointmentListItem"),L=(0,o.g2)("BottomPagination"),A=(0,o.g2)("AppointmentForm"),C=(0,o.g2)("v-dialog");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",U,[(0,o.Lk)("div",B,[(0,o.bF)(l,{class:"agentFilter",agents:a.value,modelValue:r.value.agents,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value.agents=e)},null,8,["agents","modelValue"]),(0,o.Lk)("div",P,[(0,o.bF)(u,{modelValue:r.value.status,"onUpdate:modelValue":t[1]||(t[1]=e=>r.value.status=e),items:s,label:"Status","hide-details":""},null,8,["modelValue"])]),(0,o.Lk)("div",N,[(0,o.bF)(_,{"model-value":r.value.from,ref:"fromRef",label:"From",onDateChanged:t[2]||(t[2]=e=>v("from",e)),"disable-after":r.value.to,class:"mr-2"},null,8,["model-value","disable-after"]),(0,o.bF)(_,{"model-value":r.value.to,ref:"toRef",label:"To",onDateChanged:t[3]||(t[3]=e=>v("to",e)),"disable-before":r.value.from},null,8,["model-value","disable-before"])]),(0,o.Lk)("div",j,[(0,o.bF)(h,{modelValue:r.value.searchText,"onUpdate:modelValue":t[4]||(t[4]=e=>r.value.searchText=e),label:"Search","hide-details":""},null,8,["modelValue"])])]),(0,o.Lk)("div",G,[(0,o.Lk)("div",q,(0,c.v_)(w.value.length)+" appointments found ",1),(0,o.Lk)("div",null,[(0,o.bF)(k,{color:"hotPink",onClick:t[5]||(t[5]=e=>g())},{default:(0,o.k6)((()=>[(0,o.eW)(" + "),e.$vuetify.display.smAndUp?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)("Create appointment")],64)):(0,o.Q3)("",!0)])),_:1})])]),(0,o.Lk)("div",Q,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(y.value,((e,t)=>((0,o.uX)(),(0,o.Wv)(S,{key:`appointment_${t}`,appointment:e.appointment,agents:e.agents,contacts:e.contacts,onClick:t=>g(e.appointment)},null,8,["appointment","agents","contacts","onClick"])))),128))]),(0,o.bF)(L,{pageSize:d.value.pageSize,totalLength:w.value.length,isLast:w.value.length<d.value.pageSize,onPaginate:t[6]||(t[6]=e=>m(e.offset))},null,8,["pageSize","totalLength","isLast"])]),(0,o.bF)(C,{modelValue:p.value.open,"onUpdate:modelValue":t[7]||(t[7]=e=>p.value.open=e),persistent:"","max-width":"600px",height:"900px"},{default:(0,o.k6)((()=>[p.value.model?((0,o.uX)(),(0,o.Wv)(A,{key:0,appointment:p.value.model,contacts:n.value,agents:a.value,appointments:i.value,onCancel:f,"onUpdate:modelValue":b},null,8,["appointment","contacts","agents","appointments"])):((0,o.uX)(),(0,o.Wv)(A,{key:1,contacts:n.value,agents:a.value,appointments:i.value,onCancel:f,"onUpdate:modelValue":b},null,8,["contacts","agents","appointments"]))])),_:1},8,["modelValue"])],64)}}});const J=(0,v.A)(H,[["__scopeId","data-v-82849566"]]);var Y=J;const Z={class:"listItem"},ee={class:"info"},te={key:0,class:"contactInfo"},ae={key:1},ne={class:"addressInfo"};var oe=(0,o.pM)({__name:"AppointmentListItem",props:{appointment:{},agents:{},contacts:{},showContactInfo:{type:Boolean,default:!0}},setup(e){const t=e,a=(0,u.KR)(t.appointment),n=(0,o.EW)((()=>{const e=[...t.agents].filter((e=>e.appointments.includes(a.value.record_id)));return e})),l=I.truncateString;return(0,o.wB)((()=>t.appointment),(e=>{a.value=e}),{immediate:!0,deep:!0}),(e,t)=>{const i=(0,o.g2)("v-icon"),r=(0,o.g2)("AppointmentStatus"),s=(0,o.g2)("AgentAvatarList");return(0,o.uX)(),(0,o.CE)("div",Z,[(0,o.Lk)("div",ee,[e.showContactInfo?((0,o.uX)(),(0,o.CE)("div",te,[e.contacts[0]?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("div",null,[(0,o.bF)(i,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-account")])),_:1}),(0,o.eW)(),(0,o.Lk)("span",null,(0,c.v_)(e.contacts[0].name)+" "+(0,c.v_)(e.contacts[0].surname),1)]),(0,o.Lk)("div",null,[(0,o.bF)(i,{class:"mr-1"},{default:(0,o.k6)((()=>[(0,o.eW)("mdi-email")])),_:1}),(0,o.eW)(),(0,o.Lk)("span",null,(0,c.v_)(e.contacts[0].email),1)]),(0,o.Lk)("div",null,[(0,o.bF)(i,{class:"mr-1"},{default:(0,o.k6)((()=>[(0,o.eW)("mdi-phone")])),_:1}),(0,o.eW)(),(0,o.Lk)("span",null,(0,c.v_)(e.contacts[0].phone),1)])],64)):((0,o.uX)(),(0,o.CE)("div",ae,"No contact information"))])):(0,o.Q3)("",!0),(0,o.Lk)("div",ne,[(0,o.bF)(i,{class:"mr-1"},{default:(0,o.k6)((()=>[(0,o.eW)("mdi-home")])),_:1}),(0,o.Lk)("div",null,(0,c.v_)((0,u.R1)(l)(a.value.address,35)),1)]),(0,o.bF)(r,{appointment:a.value},null,8,["appointment"])]),(0,o.bF)(s,{class:"agentInfo",agents:n.value,l2r:!0,limit:3},null,8,["agents"])])}}});const le=(0,v.A)(oe,[["__scopeId","data-v-c8adb40c"]]);var ie=le;const re={key:0},se={style:{"font-weight":"600"}},ce={class:"appointmentList"};var ue=(0,o.pM)({__name:"AppointmentForm",props:{appointment:{},contacts:{},agents:{},appointments:{}},emits:["update:model-value","cancel"],setup(e,{emit:t}){const a=e,l=t,i={required:[E.required]},r=(0,u.KR)("Create"),s=(0,u.KR)(null),d=(0,u.Kh)({valid:null,data:{address:"",contactId:"",agentIds:[],date:(new Date).toISOString(),isCancelled:!1}});function p(){l("cancel")}async function m(){if(!s.value)return!1;const e=await s.value.validate();return e.valid}async function v(){if(!await m())return void console.log("form not valid");const e={address:d.data.address,contact:[d.data.contactId],agent:d.data.agentIds,date:d.data.date,isCancelled:d.data.isCancelled,id:a.appointment?a.appointment.id:"",record_id:a.appointment?a.appointment.record_id:""};l("update:model-value",e)}function g(e){console.log("statusChanged",e)}function f(e){d.data.date=e}const b=[{title:new Date(Date.now())>new Date(d.data.date)?"Completed":"Upcoming",value:!1},{title:"Cancelled",value:!0}],_=(0,o.EW)((()=>a.agents.map((e=>({title:`${e.name} ${e.surname}`,value:e.record_id}))))),h=(0,o.EW)((()=>a.contacts.map((e=>({title:`${e.name} ${e.surname}`,value:e.record_id}))))),k=(0,o.EW)((()=>{const e=a.contacts.find((e=>e.record_id==d.data.contactId));if(!e)return[];const t=a.appointments.filter((e=>e.contact.includes(d.data.contactId)));return t}));return(0,o.wB)((()=>a.appointment),(e=>{e&&(r.value="Edit",d.data.address=e.address,d.data.agentIds=e.agent,d.data.date=e.date,d.data.contactId=e.contact?e.contact[0]:"",d.data.isCancelled=e.isCancelled)}),{immediate:!0,deep:!0}),(e,t)=>{const a=(0,o.g2)("v-icon"),l=(0,o.g2)("v-card-title"),u=(0,o.g2)("v-autocomplete"),m=(0,o.g2)("v-text-field"),S=(0,o.g2)("v-select"),w=(0,o.g2)("DatePicker"),y=(0,o.g2)("v-form"),L=(0,o.g2)("AppointmentListItem"),A=(0,o.g2)("v-card-item"),C=(0,o.g2)("v-btn"),D=(0,o.g2)("v-card-actions"),F=(0,o.g2)("v-card");return(0,o.uX)(),(0,o.Wv)(F,{class:"formContainer"},{default:(0,o.k6)((()=>[(0,o.bF)(l,{class:"formTitle"},{default:(0,o.k6)((()=>[(0,o.bF)(a,null,{default:(0,o.k6)((()=>[(0,o.eW)("mdi-calendar-blank")])),_:1}),(0,o.eW)(" "+(0,c.v_)(r.value)+" an Appointment ",1)])),_:1}),(0,o.bF)(A,null,{default:(0,o.k6)((()=>[(0,o.bF)(y,{ref_key:"formRef",ref:s,class:"appointmentForm mb-7",modelValue:d.valid,"onUpdate:modelValue":t[5]||(t[5]=e=>d.valid=e),"lazy-validation":"",onSubmit:t[6]||(t[6]=(0,n.D$)((()=>{}),["prevent"]))},{default:(0,o.k6)((()=>[(0,o.Lk)("div",null,[(0,o.bF)(u,{modelValue:d.data.contactId,"onUpdate:modelValue":t[0]||(t[0]=e=>d.data.contactId=e),items:h.value,rules:i.required,label:"Choose contact","bg-color":"white"},null,8,["modelValue","items","rules"])]),(0,o.Lk)("div",null,[(0,o.bF)(m,{modelValue:d.data.address,"onUpdate:modelValue":t[1]||(t[1]=e=>d.data.address=e),rules:i.required,label:"Address",clearable:"","bg-color":"white"},null,8,["modelValue","rules"])]),(0,o.Lk)("div",null,[(0,o.bF)(S,{modelValue:d.data.agentIds,"onUpdate:modelValue":t[2]||(t[2]=e=>d.data.agentIds=e),items:_.value,multiple:"",rules:i.required,label:"Choose Agent(s)","bg-color":"white"},null,8,["modelValue","items","rules"])]),(0,o.Lk)("div",null,[(0,o.bF)(w,{modelValue:d.data.date,label:"Choose Date",onDateChanged:t[3]||(t[3]=e=>f(e))},null,8,["modelValue"])]),"edit"==r.value?((0,o.uX)(),(0,o.CE)("div",re,[(0,o.bF)(S,{modelValue:d.data.isCancelled,"onUpdate:modelValue":t[4]||(t[4]=e=>d.data.isCancelled=e),items:b,onChange:g,label:"Status","bg-color":"white"},null,8,["modelValue"])])):(0,o.Q3)("",!0)])),_:1},8,["modelValue"]),(0,o.Lk)("div",null,[(0,o.Lk)("div",se,"Related Appointments: "+(0,c.v_)(k.value.length),1),(0,o.Lk)("div",ce,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(k.value,((t,a)=>((0,o.uX)(),(0,o.Wv)(L,{key:`app_${a}`,appointment:t,agents:e.agents,contacts:[],showContactInfo:!1},null,8,["appointment","agents"])))),128))])])])),_:1}),(0,o.bF)(D,{class:"mt-auto"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{color:"black",onClick:p},{default:(0,o.k6)((()=>[(0,o.eW)("Cancel")])),_:1}),(0,o.bF)(C,{color:"hotPink",onClick:v},{default:(0,o.k6)((()=>[(0,o.eW)((0,c.v_)("Create"==r.value?r.value:"Save"),1)])),_:1})])),_:1})])),_:1})}}});const de=(0,v.A)(ue,[["__scopeId","data-v-7bce423e"]]);var pe=de;const me={class:"dateAndStatusInfo"},ve={class:"statusInfo"},ge={key:0},fe={class:"dateInfo"};var be=(0,o.pM)({__name:"AppointmentStatus",props:{appointment:{}},setup(e){const t=e,a=(0,o.EW)((()=>V.getStatus(t.appointment))),n=F.Dates.formatDateTime;return(e,t)=>{const l=(0,o.g2)("v-icon");return(0,o.uX)(),(0,o.CE)("div",me,[(0,o.Lk)("div",ve,[(0,o.Lk)("div",{style:(0,c.Tr)({color:a.value.color})},(0,c.v_)(a.value.kind),5),"Upcoming"==a.value.kind?((0,o.uX)(),(0,o.CE)("div",ge,(0,c.v_)(a.value.remainingDays)+" days",1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",fe,[(0,o.bF)(l,{class:"mr-1"},{default:(0,o.k6)((()=>[(0,o.eW)("mdi-clock-time-five-outline")])),_:1}),(0,o.Lk)("span",null,(0,c.v_)((0,u.R1)(n)(e.appointment.date)),1)])])}}});const _e=(0,v.A)(be,[["__scopeId","data-v-cf1ff550"]]);var he=_e;const ke={install(e){e.component("BottomPagination",S).component("LoadSpinner",s).component("DatePicker",f).component("AppointmentList",Y).component("AgentAvatarList",A).component("SelectAgents",T).component("AppointmentListItem",ie).component("AppointmentForm",pe).component("AppointmentStatus",he)}};a(5524);var Se=a(7768),we=a(1920),ye=a(5741);const Le=(0,Se.$N)({components:we,directives:ye,icons:{defaultSet:"mdi"},theme:{themes:{light:{dark:!1,colors:{hotPink:"rgb(243, 109, 131)"}}}}});var Ae,Ce;(function(e){e["SET_LOADING"]="SET_LOADING"})(Ae||(Ae={})),function(e){e["SET_LOADING"]="SET_LOADING"}(Ce||(Ce={}));const De={isLoading:!1},Fe=(0,l.y$)({state:De,mutations:{[Ae.SET_LOADING](e,t){e.isLoading=t}},actions:{[Ce.SET_LOADING]({commit:e},t){e(Ae.SET_LOADING,t)}},getters:{isLoading:e=>e.isLoading}});var Ie=Fe;function Ve(e,t){const a=(0,o.g2)("LoadSpinner"),n=(0,o.g2)("AppointmentList");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(a),(0,o.bF)(n)],64)}const Ee={},Te=(0,v.A)(Ee,[["render",Ve]]);var We=Te;const Oe=(0,n.Ef)(We);Oe.use(ke).use(Le).use(Ie).mount("#app")}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,a),l.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,l){if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],l=e[u][2];for(var r=!0,s=0;s<n.length;s++)(!1&l||i>=l)&&Object.keys(a.O).every((function(e){return a.O[e](n[s])}))?n.splice(s--,1):(r=!1,l<i&&(i=l));if(r){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[n,o,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,l,i=n[0],r=n[1],s=n[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(o in r)a.o(r,o)&&(a.m[o]=r[o]);if(s)var u=s(a)}for(t&&t(n);c<i.length;c++)l=i[c],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(u)},n=self["webpackChunkmeeting_manager"]=self["webpackChunkmeeting_manager"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(974)}));n=a.O(n)})();
//# sourceMappingURL=app.18e6c59e.js.map